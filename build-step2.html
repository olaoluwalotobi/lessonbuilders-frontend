<!DOCTYPE html>
<html lang="en">
<head>
<link rel="icon" type="image/png" href="/favicon.png">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Teaching Style - LessonBuilders</title>
<link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">

<style>
:root{--navy:#0D2847;--orange:#FF8C42;}
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'DM Sans',sans-serif;background:linear-gradient(135deg,#F7FAFC 0%,#FFF 100%);color:#0D2847;}

/* -------------------------
   TOP NAV (UPDATED)
   - mobile: logo + LB on top row, menu on row below (scrollable)
   - removes conflicting duplicate @media blocks from your original
   ------------------------- */
.top-nav{
  background:white;border-bottom:2px solid rgba(13,40,71,0.1);
  padding:16px 40px;
  position:sticky;top:0;z-index:1000;
  box-shadow:0 2px 8px rgba(0,0,0,0.05);

  display:flex;
  flex-direction:column;
  gap:10px;
}
.nav-top-row{
  width:100%;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
}
.logo-text{
  font-family:'Crimson Pro',serif;font-size:24px;font-weight:700;color:var(--navy);
  text-decoration:none;
  white-space:nowrap;
}
.nav-right{display:flex;align-items:center;gap:16px;flex:0 0 auto;}
.user-profile{
  width:36px;height:36px;border-radius:50%;
  background:linear-gradient(135deg,var(--orange),#FFB380);
  display:flex;align-items:center;justify-content:center;color:white;
  font-weight:600;font-size:14px;cursor:pointer;
  flex:0 0 auto;
}
.nav-menu{
  width:100%;
  display:flex;
  gap:32px;
  align-items:center;
}
.nav-link{
  text-decoration:none;color:#4A5568;font-weight:500;font-size:15px;
  transition:color 0.2s;
  white-space:nowrap;
}
.nav-link:hover{color:var(--navy);}

/* Main layout */
.container{display:flex;max-width:1400px;margin:0 auto;}
.sidebar{width:280px;background:white;border-right:1px solid rgba(13,40,71,0.1);padding:30px 20px;}
.nav-step{display:flex;align-items:center;gap:12px;padding:12px;margin-bottom:8px;cursor:pointer;transition:all 0.2s;border-left:3px solid transparent;text-decoration:none;color:#4A5568;}
.nav-step.active{background:rgba(255,140,66,0.1);border-left-color:var(--orange);color:var(--navy);font-weight:600;}
/* lock left-step navigation (visual only) */
.sidebar .nav-step{pointer-events:none;cursor:default;}
.nav-step.completed{color:#10B981;}
.step-number{width:28px;height:28px;border-radius:50%;background:#F7FAFC;border:2px solid #E2E8F0;display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:600;color:#999;}
.nav-step.active .step-number{background:var(--orange);border-color:var(--orange);color:white;}
.nav-step.completed .step-number{background:#10B981;border-color:#10B981;color:white;}
.main-content{flex:1;padding:40px 60px;max-width:900px;}
.page-title{font-family:'Crimson Pro',serif;font-size:42px;font-weight:700;margin-bottom:12px;color:var(--navy);}
.page-subtitle{font-size:18px;color:#4A5568;margin-bottom:40px;}
.progress-bar{height:6px;background:#E2E8F0;border-radius:3px;margin-bottom:40px;}
.progress-fill{height:100%;background:linear-gradient(90deg,var(--orange),#FFB380);border-radius:3px;}
.style-slider{margin-bottom:32px;}
.style-label{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;font-weight:600;color:var(--navy);}

/* -------------------------
   PERCENT INPUTS (UPDATED)
   - replaces span % with a small editable input
   - keeps your layout stable
   ------------------------- */
.style-value-wrap{display:flex;align-items:center;gap:8px;justify-content:flex-end;}
.style-value-input{
  width:70px;
  text-align:center;
  padding:10px 10px;
  border-radius:12px;
  border:2px solid #E2E8F0;
  font-family:'DM Sans',sans-serif;
  font-weight:800;
  color:var(--orange);
  background:white;
  outline:none;
}
.style-value-input:focus{
  border-color: rgba(255,140,66,0.85);
  box-shadow: 0 0 0 4px rgba(255,140,66,0.14);
}
.style-value-sign{font-weight:900;color:var(--orange);}

.slider{width:100%;height:8px;border-radius:4px;background:#E2E8F0;appearance:none;cursor:pointer;outline:none;}
.slider::-webkit-slider-thumb{appearance:none;width:24px;height:24px;border-radius:50%;background:var(--orange);cursor:pointer;border:3px solid white;box-shadow:0 2px 4px rgba(0,0,0,0.2);}
.slider::-moz-range-thumb{width:24px;height:24px;border-radius:50%;background:var(--orange);cursor:pointer;border:3px solid white;box-shadow:0 2px 4px rgba(0,0,0,0.2);}

.btn{padding:14px 28px;border-radius:10px;font-size:15px;font-weight:600;cursor:pointer;transition:all 0.3s;text-decoration:none;display:inline-block;border:none;}
.btn-primary{background:linear-gradient(135deg,var(--orange),#FFB380);color:white;}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(255,140,66,0.4);}
.btn-secondary{background:white;border:2px solid #E2E8F0;color:var(--navy);}
.btn-secondary:hover{border-color:var(--orange);}
.btn-group{display:flex;justify-content:space-between;margin-top:40px;}

/* ================================
   Mobile / Tablet responsiveness
   ================================ */
@media (max-width: 900px){
  .top-nav{padding:12px 16px;}
  /* menu becomes scrollable row below */
  .nav-menu{
    flex-wrap:nowrap;
    overflow-x:auto;
    -webkit-overflow-scrolling:touch;
    gap:16px;
    padding-bottom:2px;
  }
  .nav-menu::-webkit-scrollbar{display:none;}
  .nav-link{font-size:14px;}

  .container{flex-direction:column;max-width:100%;}
  .sidebar{
    width:100%;
    border-right:none;
    border-bottom:1px solid rgba(13,40,71,0.1);
    padding:14px 12px;
    display:flex;
    gap:10px;
    overflow-x:auto;
    -webkit-overflow-scrolling:touch;
  }
  .sidebar > div:first-child{display:none;}
  .nav-step{
    flex:0 0 auto;
    margin-bottom:0;
    padding:10px 12px;
    border-left:none;
    border-bottom:3px solid transparent;
    border-radius:10px;
    background:#fff;
    white-space:nowrap;
  }
  .nav-step.active{
    border-bottom-color:var(--orange);
    background:rgba(255,140,66,0.08);
  }
  .step-number{flex:0 0 auto;}
  .main-content{padding:22px 16px;max-width:100%;}
  .btn{width:auto;}
}

@media (max-width: 520px){
  .logo-text{font-size:20px;}
  .page-title{font-size:32px;}
  .page-subtitle{font-size:15px;}
}
</style>
</head>

<body>

<!-- TOP NAV (UPDATED STRUCTURE) -->
<nav class="top-nav">
  <div class="nav-top-row">
    <a href="index.html" class="logo-text">LessonBuilders</a>
    <div class="nav-right">
      <div class="user-profile" id="userProfile">LB</div>
    </div>
  </div>

  <div class="nav-menu">
    <a href="build-step1.html" class="nav-link">Build</a>
    <a href="library.html" class="nav-link">My Lessons</a>
    <a href="assessments.html" class="nav-link">Assessments</a>
    <a href="discover.html" class="nav-link">Discover</a>
    <a href="about.html" class="nav-link">Help</a>
  </div>
</nav>

<div class="container">
  <aside class="sidebar">
    <div style="font-size:13px;font-weight:700;text-transform:uppercase;letter-spacing:0.5px;color:#999;margin-bottom:16px;">BUILD LESSON</div>
    <div class="nav-step completed"><div class="step-number">&#10003;</div><div>Basics</div></div>
    <div class="nav-step active"><div class="step-number">2</div><div>Style</div></div>
    <div class="nav-step"><div class="step-number">3</div><div>Template</div></div>
    <div class="nav-step"><div class="step-number">4</div><div>Assessments</div></div>
    <div class="nav-step"><div class="step-number">5</div><div>Build</div></div>
    <div class="nav-step"><div class="step-number">6</div><div>Preview</div></div>
    <div class="nav-step"><div class="step-number">7</div><div>Team Up</div></div>
  </aside>

  <main class="main-content">
    <h1 class="page-title">How do you teach?</h1>
    <p class="page-subtitle">Help us match your classroom style</p>
    <div class="progress-bar"><div class="progress-fill" style="width:25%;"></div></div>

    <!-- Sliders (UPDATED % UI only) -->
    <div class="style-slider">
      <div class="style-label">
        <span>Hands-On Activities</span>
        <span class="style-value-wrap">
          <input class="style-value-input" id="handsOnValue" inputmode="numeric" pattern="[0-9]*" value="20" aria-label="Hands-On Activities percent">
          <span class="style-value-sign">%</span>
        </span>
      </div>
      <input type="range" min="0" max="100" step="1" value="20" class="slider" id="handsOnSlider">
    </div>

    <div class="style-slider">
      <div class="style-label">
        <span>Direct Instruction</span>
        <span class="style-value-wrap">
          <input class="style-value-input" id="directValue" inputmode="numeric" pattern="[0-9]*" value="20" aria-label="Direct Instruction percent">
          <span class="style-value-sign">%</span>
        </span>
      </div>
      <input type="range" min="0" max="100" step="1" value="20" class="slider" id="directSlider">
    </div>

    <div class="style-slider">
      <div class="style-label">
        <span>Collaborative Work</span>
        <span class="style-value-wrap">
          <input class="style-value-input" id="collabValue" inputmode="numeric" pattern="[0-9]*" value="20" aria-label="Collaborative Work percent">
          <span class="style-value-sign">%</span>
        </span>
      </div>
      <input type="range" min="0" max="100" step="1" value="20" class="slider" id="collabSlider">
    </div>

    <div class="style-slider">
      <div class="style-label">
        <span>Independent Practice</span>
        <span class="style-value-wrap">
          <input class="style-value-input" id="indepValue" inputmode="numeric" pattern="[0-9]*" value="20" aria-label="Independent Practice percent">
          <span class="style-value-sign">%</span>
        </span>
      </div>
      <input type="range" min="0" max="100" step="1" value="20" class="slider" id="indepSlider">
    </div>

    <div class="style-slider">
      <div class="style-label">
        <span>Technology Integration</span>
        <span class="style-value-wrap">
          <input class="style-value-input" id="techValue" inputmode="numeric" pattern="[0-9]*" value="20" aria-label="Technology Integration percent">
          <span class="style-value-sign">%</span>
        </span>
      </div>
      <input type="range" min="0" max="100" step="1" value="20" class="slider" id="techSlider">
    </div>

    <!-- Combined Total (UNCHANGED from your original) -->
    <div style="margin-top:24px;padding:16px;background:rgba(255,140,66,0.05);border-radius:10px;text-align:center;">
      <div style="font-size:14px;color:#4A5568;margin-bottom:4px;">Combined Total</div>
      <div style="font-size:28px;font-weight:700;color:var(--navy);" id="totalValue">100%</div>
    </div>

    <!-- Buttons (UNCHANGED from your original) -->
    <div class="btn-group">
      <a href="build-step1.html" class="btn btn-secondary">&larr; Back</a>
      <button class="btn btn-primary" onclick="saveAndContinue()">Next: Choose Template &rarr;</button>
    </div>
  </main>
</div>

<script>
/* -------------------------
   Load saved Step 2 (unchanged behavior)
   ------------------------- */
window.addEventListener('DOMContentLoaded', function() {
  const saved = localStorage.getItem('lessonData');
  if (saved) {
    const data = JSON.parse(saved);
    if (data.step2) {
      document.getElementById('handsOnSlider').value = data.step2.handsOn ?? 20;
      document.getElementById('directSlider').value  = data.step2.direct ?? 20;
      document.getElementById('collabSlider').value  = data.step2.collaborative ?? 20;
      document.getElementById('indepSlider').value   = data.step2.independent ?? 20;
      document.getElementById('techSlider').value    = data.step2.technology ?? 20;
    }
  }
  updateAllDisplays();
});

/* -------------------------
   Slider + editable % binding (NEW)
   ------------------------- */
const sliders = {
  handsOn: document.getElementById('handsOnSlider'),
  direct:  document.getElementById('directSlider'),
  collab:  document.getElementById('collabSlider'),
  indep:   document.getElementById('indepSlider'),
  tech:    document.getElementById('techSlider')
};

const values = {
  handsOn: document.getElementById('handsOnValue'),
  direct:  document.getElementById('directValue'),
  collab:  document.getElementById('collabValue'),
  indep:   document.getElementById('indepValue'),
  tech:    document.getElementById('techValue')
};

const totalDisplay = document.getElementById('totalValue');

function clampInt(v, min, max) {
  const n = parseInt(String(v).replace(/[^\d]/g,''), 10);
  if (!Number.isFinite(n)) return min;
  return Math.max(min, Math.min(max, n));
}

function getTotal() {
  return parseInt(sliders.handsOn.value,10) +
         parseInt(sliders.direct.value,10)  +
         parseInt(sliders.collab.value,10)  +
         parseInt(sliders.indep.value,10)   +
         parseInt(sliders.tech.value,10);
}

function updateTotal() {
  const total = getTotal();
  totalDisplay.textContent = total + '%';

  if (total === 100) totalDisplay.style.color = '#10B981';
  else if (total > 100) totalDisplay.style.color = '#EF4444';
  else totalDisplay.style.color = 'var(--orange)';
}

function updateAllDisplays() {
  values.handsOn.value = sliders.handsOn.value;
  values.direct.value  = sliders.direct.value;
  values.collab.value  = sliders.collab.value;
  values.indep.value   = sliders.indep.value;
  values.tech.value    = sliders.tech.value;
  updateTotal();
}

function bind(sliderEl, inputEl) {
  if (!sliderEl || !inputEl) return;

  // slider -> input
  sliderEl.addEventListener('input', function() {
    inputEl.value = this.value;
    updateTotal();
  });

  // keep digits-only while typing
  inputEl.addEventListener('input', function() {
    this.value = this.value.replace(/[^\d]/g,'');
  });

  // input -> slider on blur / Enter
  function commit() {
    const min = sliderEl.min ? parseInt(sliderEl.min,10) : 0;
    const max = sliderEl.max ? parseInt(sliderEl.max,10) : 100;
    const v = clampInt(inputEl.value, min, max);
    inputEl.value = String(v);
    sliderEl.value = String(v);
    updateTotal();
  }

  inputEl.addEventListener('blur', commit);
  inputEl.addEventListener('keydown', function(e) {
    if (e.key === 'Enter') {
      e.preventDefault();
      inputEl.blur();
    }
  });
}

bind(sliders.handsOn, values.handsOn);
bind(sliders.direct,  values.direct);
bind(sliders.collab,  values.collab);
bind(sliders.indep,   values.indep);
bind(sliders.tech,    values.tech);

updateTotal();

/* -------------------------
   Save + continue (UNCHANGED logic)
   ------------------------- */
function saveAndContinue() {
  const total = getTotal();

  if (total !== 100) {
    alert('Please adjust the sliders so they total exactly 100%');
    return;
  }

  const teachingStyles = {
    handsOn: parseInt(sliders.handsOn.value,10),
    direct: parseInt(sliders.direct.value,10),
    collaborative: parseInt(sliders.collab.value,10),
    independent: parseInt(sliders.indep.value,10),
    technology: parseInt(sliders.tech.value,10)
  };

  let lessonData = {};
  const saved = localStorage.getItem('lessonData');
  if (saved) lessonData = JSON.parse(saved);

  lessonData.step2 = teachingStyles;
  localStorage.setItem('lessonData', JSON.stringify(lessonData));
  window.location.href = 'build-step3.html';
}
</script>

<script type="module">
  // Update the top-right bubble to show initials when logged in.
  // Falls back to "LB" when logged out or if auth isn't available.
  function initialsFromEmail(email) {
    if (!email) return "LB";
    const namePart = String(email).split("@")[0] || "";
    const tokens = namePart.split(/[.\-_]/).filter(Boolean);
    const a = tokens[0]?.[0] || "";
    const b = tokens[1]?.[0] || tokens[0]?.[1] || "";
    const ini = (a + b).toUpperCase();
    return ini || "LB";
  }

  const el = document.getElementById("userProfile");
  if (!el) return;

  try {
    const raw = localStorage.getItem("lb_user") || localStorage.getItem("user") || "";
    if (raw) {
      const u = JSON.parse(raw);
      const email = u?.email || u?.user?.email;
      el.textContent = initialsFromEmail(email);
    } else {
      el.textContent = "LB";
    }
  } catch {
    el.textContent = "LB";
  }
</script>

</body>
</html>
