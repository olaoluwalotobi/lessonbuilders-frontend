<!DOCTYPE html>
<html lang="en">
<head>
<link rel="icon" type="image/png" href="/favicon.png">

  
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Collaborate - LessonBuilders</title>
<link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
<style>

  /* Sidebar is a progress indicator only */
.sidebar .nav-step{
  cursor: default;
}
.sidebar .nav-step.is-static{
  pointer-events: none;     /* disables clicking */
}

  
:root{--navy:#0D2847;--orange:#FF8C42;}
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'DM Sans',sans-serif;background:linear-gradient(135deg,#F7FAFC 0%,#FFF 100%);color:#0D2847;}
.top-nav{background:white;border-bottom:2px solid rgba(13,40,71,0.1);padding:16px 40px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:1000;box-shadow:0 2px 8px rgba(0,0,0,0.05);}
.nav-left{display:flex;align-items:center;gap:40px;}
.logo-text{font-family:'Crimson Pro',serif;font-size:24px;font-weight:700;color:var(--navy);text-decoration:none;}
.nav-menu{display:flex;gap:32px;align-items:center;}
.nav-link{text-decoration:none;color:#4A5568;font-weight:500;font-size:15px;transition:color 0.2s;}
.nav-link:hover{color:var(--navy);}
.nav-right{display:flex;align-items:center;gap:16px;}
.user-profile{width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,var(--orange),#FFB380);display:flex;align-items:center;justify-content:center;color:white;font-weight:600;font-size:14px;cursor:default;}
.container{display:flex;max-width:1400px;margin:0 auto;}
.sidebar{width:280px;background:white;border-right:1px solid rgba(13,40,71,0.1);padding:30px 20px;}
.nav-step{display:flex;align-items:center;gap:12px;padding:12px;margin-bottom:8px;cursor:default;transition:all 0.2s;border-left:3px solid transparent;text-decoration:none;color:#4A5568;}
.nav-step.active{background:rgba(255,140,66,0.1);border-left-color:var(--orange);color:var(--navy);font-weight:600;}
.nav-step.completed{color:#10B981;}
.step-number{width:28px;height:28px;border-radius:50%;background:#F7FAFC;border:2px solid #E2E8F0;display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:600;color:#999;}
.nav-step.active .step-number{background:var(--orange);border-color:var(--orange);color:white;}
.nav-step.completed .step-number{background:#10B981;border-color:#10B981;color:white;}
.main-content{flex:1;padding:40px 60px;max-width:900px;}
.page-title{font-family:'Crimson Pro',serif;font-size:42px;font-weight:700;margin-bottom:12px;color:var(--navy);}
.progress-bar{height:6px;background:#E2E8F0;border-radius:3px;margin-bottom:40px;}
.progress-fill{height:100%;background:linear-gradient(90deg,var(--orange),#FFB380);border-radius:3px;}
.success-banner{background:rgba(16,185,129,0.1);border-left:4px solid #10B981;border-radius:8px;padding:16px 20px;margin-bottom:32px;display:flex;align-items:center;justify-content:space-between;}
.success-content{display:flex;align-items:center;gap:12px;}
.success-text{color:#047857;font-weight:600;font-size:15px;}
.collab-intro{background:rgba(255,140,66,0.05);border-left:4px solid var(--orange);padding:20px;border-radius:8px;margin-bottom:32px;}
.collab-intro p{color:#4A5568;line-height:1.6;}
.suggestion-card{background:white;border:2px solid #E2E8F0;border-radius:16px;padding:24px;margin-bottom:16px;transition:all 0.3s;}
.suggestion-card:hover{border-color:var(--orange);box-shadow:0 4px 16px rgba(0,0,0,0.08);}
.suggestion-header{display:flex;justify-content:space-between;align-items:start;margin-bottom:12px;}
.suggestion-title{font-size:18px;font-weight:700;color:var(--navy);}
.suggestion-badge{background:rgba(255,140,66,0.1);color:var(--orange);padding:4px 12px;border-radius:6px;font-size:13px;font-weight:600;}
.suggestion-description{color:#4A5568;line-height:1.6;margin-bottom:12px;}
.suggestion-contact{display:flex;align-items:center;margin-top:16px;}
.btn{padding:14px 28px;border-radius:10px;font-size:15px;font-weight:600;cursor:default;transition:all 0.3s;text-decoration:none;display:inline-block;border:none;}
.btn-primary{background:linear-gradient(135deg,var(--orange),#FFB380);color:white;}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(255,140,66,0.4);}
.btn-email{background:var(--orange);color:white;padding:10px 20px;font-size:14px;border-radius:8px;border:none;display:inline-flex;align-items:center;gap:8px;}
.btn-email:hover{background:#FF6B2C;}
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);z-index:2000;align-items:center;justify-content:center;}
.modal.show{display:flex;}
.modal-content{background:white;border-radius:20px;padding:40px;max-width:600px;width:90%;max-height:80vh;overflow-y:auto;}
.modal-title{font-family:'Crimson Pro',serif;font-size:28px;font-weight:700;color:var(--navy);margin-bottom:8px;}
.modal-subtitle{font-size:14px;color:#718096;margin-bottom:24px;}
.email-template{background:#F7FAFC;border:2px solid #E2E8F0;border-radius:12px;padding:20px;margin-bottom:24px;}
.email-field{margin-bottom:16px;}
.email-field-label{font-size:13px;font-weight:600;color:#718096;text-transform:uppercase;letter-spacing:0.5px;margin-bottom:6px;}
.email-field-content{font-size:15px;color:var(--navy);line-height:1.6;}
.email-body{background:white;border:2px solid #E2E8F0;border-radius:8px;padding:16px;min-height:200px;font-family:'DM Sans',sans-serif;font-size:15px;line-height:1.6;resize:vertical;width:100%;}
.modal-buttons{display:flex;gap:12px;justify-content:flex-end;}
.btn-secondary{background:white;border:2px solid #E2E8F0;color:var(--navy);}
.btn-secondary:hover{border-color:var(--orange);}
.btn-copy{background:var(--orange);color:white;}
.btn-copy:hover{background:#FF6B2C;}
/* ================================
   Mobile / Tablet responsiveness
   (added by LessonBuilders)
   ================================ */
@media (max-width: 900px){
  .top-nav{padding:12px 16px;flex-wrap:wrap;gap:10px;}
  .nav-left{gap:16px;flex-wrap:wrap;}
  .nav-menu{gap:16px;flex-wrap:wrap;}
  .container{flex-direction:column;max-width:100%;}
  .sidebar{
    width:100%;
    border-right:none;
    border-bottom:1px solid rgba(13,40,71,0.1);
    padding:14px 12px;
    display:flex;
    gap:10px;
    overflow-x:auto;
    -webkit-overflow-scrolling:touch;
  }
  .sidebar > div:first-child{display:none;} /* hide "BUILD LESSON" label on mobile */
  .nav-step{
    flex:0 0 auto;
    margin-bottom:0;
    padding:10px 12px;
    border-left:none;
    border-bottom:3px solid transparent;
    border-radius:10px;
    background:#fff;
    white-space:nowrap;
  }
  .nav-step.active{
    border-bottom-color:var(--orange);
    background:rgba(255,140,66,0.08);
  }
  .nav-step.completed{
    color:var(--green);
  }
  .step-number{flex:0 0 auto;}
  .main-content{padding:22px 16px;max-width:100%;}
  .btn-row{flex-wrap:nowrap;gap:10px;}
  .export-group{width:100%;}
  .btn{width:auto;}
}

@media (max-width: 520px){
  .logo-text{font-size:20px;}
  .page-title{font-size:32px;}
  .page-subtitle{font-size:15px;}
  .lesson-title{font-size:22px;}
  .btn-row{flex-direction:column;align-items:stretch;}
  .btn-row .btn{width:100%;}
  .export-group{justify-content:space-between;}
}


/* Sidebar nav is visual only (locked) */
.nav-step{cursor:default;}

</style>
</head>
<body>
<nav class="top-nav">
<div class="nav-left">
<a href="index.html" class="logo-text">LessonBuilders</a>
<div class="nav-menu">
<a href="library.html" class="nav-link">My Lessons</a>
<a href="discover.html" class="nav-link">Discover</a>
<a href="about.html" class="nav-link">Help</a>
</div>
</div>
<div class="nav-right">
<div class="user-profile">JD</div>
</div>
</nav>
<div class="container">
<aside class="sidebar">
<div style="font-size:13px;font-weight:700;text-transform:uppercase;letter-spacing:0.5px;color:#999;margin-bottom:16px;">BUILD LESSON</div>
<div class="nav-step completed"><div class="step-number">&#10003;</div><div>Basic Information</div></div>
<div class="nav-step completed"><div class="step-number">&#10003;</div><div>Teaching Style</div></div>
<div class="nav-step completed"><div class="step-number">&#10003;</div><div>Choose Template</div></div>
<div class="nav-step completed"><div class="step-number">&#10003;</div><div>Build Method</div></div>
<div class="nav-step completed"><div class="step-number">&#10003;</div><div>Assessments</div></div>
<div class="nav-step completed"><div class="step-number">&#10003;</div><div>Preview & Export</div></div>
<div class="nav-step active"><div class="step-number">7</div><div>Collaborate</div></div>
</aside>
<main class="main-content">
<div class="success-banner">
<div class="success-content">
<div style="font-size:24px;">&#10003;</div>
<div class="success-text">Your lesson was successfully saved to My Lessons</div>
</div>
</div>

<h1 class="page-title">Subjects that connect with your lesson</h1>
<div class="progress-bar"><div class="progress-fill" style="width:100%;"></div></div>

<div class="collab-intro">
<p>Teaming up can create better learning experiences for students across subjects.</p>
</div>

<div style="margin-bottom:32px;" id="collaborationSuggestions">
<!-- Suggestions populated by JavaScript -->
</div>

<div style="text-align:center;margin-top:48px;padding-top:32px;border-top:2px solid #E2E8F0;">
<a href="build-step1.html" class="btn btn-primary">Build New Lesson &rarr;</a>
<div style="font-size:14px;color:#718096;margin-top:16px;">Your current lesson has been saved to My Lessons</div>
</div>

</main>
</div>

<!-- Email Modal -->
<div class="modal" id="emailModal">
<div class="modal-content">
<div class="modal-title">Pre-Written Email</div>
<div class="modal-subtitle">Review and edit before copying to your email</div>

<div class="email-template">
<div class="email-field">
<div class="email-field-label">Subject</div>
<div class="email-field-content" id="emailSubject">Collaboration Opportunity</div>
</div>
</div>

<textarea class="email-body" id="emailBody" rows="12"></textarea>

<div class="modal-buttons">
<button class="btn btn-secondary" onclick="closeEmailModal()">Close</button>
<button class="btn btn-copy" onclick="copyEmail()">&#128203; Copy to Clipboard</button>
</div>
</div>
</div>

<!-- Congratulations Modal -->
<div class="modal" id="congratsModal">
<div class="modal-content" style="text-align:center;max-width:500px;">
<div style="font-size:64px;margin-bottom:16px;">ðŸ“§</div>
<div class="modal-title">Collaboration Outreach Sent!</div>
<div style="font-size:16px;color:#4A5568;line-height:1.7;margin-bottom:24px;">
<p style="margin-bottom:12px;">Great! Your lesson now has a "Pending..." badge. Once you've sent the email and collaborated, you can confirm it to earn the full "Collaborated" badge.</p>
<p>Teaming up across subjects creates richer learning experiences and helps students make meaningful connections between different areas of knowledge.</p>
</div>
<button class="btn btn-primary" onclick="closeCongratsModal()" style="width:100%;">Continue</button>
</div>
</div>

<script>

function lockSidebarProgressNav(){
  // Sidebar steps are a progress indicator only (no navigation).
  document.querySelectorAll(".sidebar a.nav-step").forEach(a => {
    a.classList.add("is-static");
    a.setAttribute("aria-disabled","true");
    a.setAttribute("tabindex","-1");

    // Make navigation impossible even if CSS is overridden.
    try {
      const href = a.getAttribute("href");
      if (href && href !== "#" && href !== "javascript:void(0)") a.setAttribute("data-href", href);
    } catch(_) {}
    a.setAttribute("href", "javascript:void(0)");

    a.addEventListener("click", (e) => {
      e.preventDefault();
      e.stopPropagation();
    }, { passive:false });
  });
}

  
const subjectCollaborations = {
  'Mathematics': [
    { subject: 'Science', teacher: 'Maria Chen', email: 'mchen@school.edu', description: 'Students can apply fraction concepts to real-world data collection and measurement activities.' },
    { subject: 'Arts', teacher: 'David Park', email: 'dpark@school.edu', description: 'Students can create visual fraction representations and explore geometric patterns through artistic design.' },
    { subject: 'Life Skills', teacher: 'Sarah Johnson', email: 'sjohnson@school.edu', description: 'Students can apply fractions to real recipes, measuring ingredients, and practical cooking scenarios.' }
  ],
  'Science': [
    { subject: 'Mathematics', teacher: 'James Wilson', email: 'jwilson@school.edu', description: 'Mathematical concepts can enhance data analysis and measurement activities.' },
    { subject: 'English Language Arts (ELA)', teacher: 'Emily Rodriguez', email: 'erodriguez@school.edu', description: 'Science writing and research skills can be integrated for better communication.' },
    { subject: 'Technology', teacher: 'Alex Kim', email: 'akim@school.edu', description: 'Digital tools and simulations can enhance hands-on science exploration.' }
  ],
  'English Language Arts (ELA)': [
    { subject: 'Social Studies / History', teacher: 'Robert Lee', email: 'rlee@school.edu', description: 'Historical contexts can enrich literary analysis and writing activities.' },
    { subject: 'Arts', teacher: 'David Park', email: 'dpark@school.edu', description: 'Visual storytelling and creative expression can enhance comprehension.' },
    { subject: 'Science', teacher: 'Maria Chen', email: 'mchen@school.edu', description: 'Science topics can provide engaging contexts for reading and writing.' }
  ],
  'Social Studies / History': [
    { subject: 'English Language Arts (ELA)', teacher: 'Emily Rodriguez', email: 'erodriguez@school.edu', description: 'Reading primary sources and writing historical narratives enhance understanding.' },
    { subject: 'Arts', teacher: 'David Park', email: 'dpark@school.edu', description: 'Historical art and visual culture provide deeper cultural context.' },
    { subject: 'Geography', teacher: 'Tom Anderson', email: 'tanderson@school.edu', description: 'Geographic knowledge enhances understanding of historical events.' }
  ],
  'default': [
    { subject: 'English Language Arts (ELA)', teacher: 'Emily Rodriguez', email: 'erodriguez@school.edu', description: 'Reading and writing activities can reinforce subject-specific concepts.' },
    { subject: 'Arts', teacher: 'David Park', email: 'dpark@school.edu', description: 'Creative expression and visual learning can enhance understanding.' },
    { subject: 'Science', teacher: 'Maria Chen', email: 'mchen@school.edu', description: 'Scientific inquiry methods can complement your lesson content.' }
  ]
};

let currentLessonData = {};
let currentCollabPartner = null; // Store collaboration partner info for pending status

window.addEventListener('DOMContentLoaded', function() {
  lockSidebarProgressNav(); // 
  const saved = localStorage.getItem('lessonData');
  if (saved) {
    currentLessonData = JSON.parse(saved);
    
    const subject = currentLessonData.step1?.subject || 'Mathematics';
    const suggestions = subjectCollaborations[subject] || subjectCollaborations['default'];
    
    const container = document.getElementById('collaborationSuggestions');
    container.innerHTML = suggestions.map(collab => `
      <div class="suggestion-card">
        <div class="suggestion-header">
          <div class="suggestion-title">${collab.subject} Connection</div>
          <div class="suggestion-badge">${subject.split(' ')[0]} + ${collab.subject.split(' ')[0]}</div>
        </div>
        <div class="suggestion-description">
          This lesson works well with ${collab.subject}. ${collab.description}
        </div>
        <div class="suggestion-contact">
          <button class="btn-email" onclick='openEmailModal(${JSON.stringify(collab)})'>&#9993; Preview Pre-Written Email</button>
        </div>
      </div>
    `).join('');
    
    // CRITICAL: Set hasVisitedStep7 for THIS lesson to track per-lesson
    currentLessonData.hasVisitedStep7 = true;
    localStorage.setItem('lessonData', JSON.stringify(currentLessonData));
  }
});

function openEmailModal(collab) {
  // Store collaboration partner for later use in badge system
  currentCollabPartner = collab;
  
  const modal = document.getElementById('emailModal');
  const emailBody = document.getElementById('emailBody');
  const emailSubject = document.getElementById('emailSubject');
  
  const lessonTitle = currentLessonData.step1?.topic || 'my lesson';
  const grade = currentLessonData.step1?.grade || '5th Grade';
  const subject = currentLessonData.step1?.subject || 'Mathematics';
  
  // Set dynamic subject line
  emailSubject.textContent = `Collaboration Opportunity: ${subject} + ${collab.subject}`;
  
  const template = `Hi [Insert collaborator name here],

I am going to be teaching a lesson on ${lessonTitle} in ${grade} ${subject}. My lesson could match well with ${collab.subject}. Would you be interested in collaborating?

Best,
[Insert your name here]
[Insert your email sign off here]`;
  
  emailBody.value = template;
  modal.classList.add('show');
}

function closeEmailModal() {
  document.getElementById('emailModal').classList.remove('show');
}

function copyEmail() {
  const emailBody = document.getElementById('emailBody');
  emailBody.select();
  document.execCommand('copy');
  
  const btn = event.target;
  const originalText = btn.innerHTML;
  btn.innerHTML = '&#10003; Copied!';
  btn.style.background = '#10B981';
  
  setTimeout(() => {
    btn.innerHTML = originalText;
    btn.style.background = '';
    
    // Close email modal
    closeEmailModal();
    
    // Set collaboration as PENDING (not confirmed yet)
    currentLessonData.collaborationPending = true;
    currentLessonData.hasCollaborations = false; // Not confirmed yet
    
    // Store collaboration details for later confirmation
    currentLessonData.collaborationStatus = {
      teacher: currentCollabPartner.teacher,
      subject: currentCollabPartner.subject,
      email: currentCollabPartner.email,
      timestamp: Date.now(),
      confirmed: false // Will be set to true when user confirms later
    };
    
    localStorage.setItem('lessonData', JSON.stringify(currentLessonData));
    
    // Show congratulations modal
    document.getElementById('congratsModal').classList.add('show');
  }, 1000);
}

function closeCongratsModal() {
  document.getElementById('congratsModal').classList.remove('show');
}

document.getElementById('emailModal').addEventListener('click', function(e) {
  if (e.target === this) {
    closeEmailModal();
  }
});

document.getElementById('congratsModal').addEventListener('click', function(e) {
  if (e.target === this) {
    closeCongratsModal();
  }
});
</script>

</body>
</html>
